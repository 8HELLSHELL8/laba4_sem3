{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import Cookies from'js-cookie';import'../css/AuthPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AuthPage=_ref=>{let{updateAuthState}=_ref;const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[rememberMe,setRememberMe]=useState(false);const[error,setError]=useState('');const[isLoading,setIsLoading]=useState(false);const navigate=useNavigate();const handleSubmit=async e=>{e.preventDefault();setError('');setIsLoading(true);const csrfToken=Cookies.get('_csrfToken');const requestHeaders={'Content-Type':'application/json'};if(csrfToken){requestHeaders['X-CSRF-Token']=csrfToken;}try{const response=await axios.post('http://localhost:5000/api/login',{name:username,password},{withCredentials:true,headers:requestHeaders});console.log('Login successful, server response:',response.data);if(typeof updateAuthState==='function'){updateAuthState(true,response.data.user);}navigate('/home',{replace:true});}catch(err){let errorMessage='Error while auth';if(err.response&&err.response.data&&err.response.data.message){errorMessage=err.response.data.message;}else if(err.message){errorMessage=err.message;}setError(errorMessage);console.error(\"Login error:\",err.response||err.message||err);}finally{setIsLoading(false);}};return/*#__PURE__*/_jsx(\"div\",{className:\"auth-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"auth-card\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"auth-title\",children:\"Authorize\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"auth-error\",children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"auth-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",children:\"Login\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",value:username,onChange:e=>setUsername(e.target.value),required:true,placeholder:\"Enter your login\",autoComplete:\"username\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true,placeholder:\"Enter your password\",autoComplete:\"current-password\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"auth-button\",disabled:isLoading,children:isLoading?'Entering...':'Submit'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"auth-footer\",children:[\"No account? \",/*#__PURE__*/_jsx(\"a\",{children:\" lol go cry then\"})]})]})});};export default AuthPage;","map":{"version":3,"names":["React","useState","useNavigate","axios","Cookies","jsx","_jsx","jsxs","_jsxs","AuthPage","_ref","updateAuthState","username","setUsername","password","setPassword","rememberMe","setRememberMe","error","setError","isLoading","setIsLoading","navigate","handleSubmit","e","preventDefault","csrfToken","get","requestHeaders","response","post","name","withCredentials","headers","console","log","data","user","replace","err","errorMessage","message","className","children","onSubmit","htmlFor","type","id","value","onChange","target","required","placeholder","autoComplete","disabled"],"sources":["/home/anton/laba4/frontend/src/pages/AuthPage.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios'; \nimport Cookies from 'js-cookie'; \nimport '../css/AuthPage.css'; \n\n\nconst AuthPage = ({ updateAuthState }) => {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [rememberMe, setRememberMe] = useState(false);\n  const [error, setError] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const navigate = useNavigate();\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n    setIsLoading(true);\n\n    const csrfToken = Cookies.get('_csrfToken');\n    \n    const requestHeaders = {\n      'Content-Type': 'application/json', \n    };\n\n    if (csrfToken) {\n      requestHeaders['X-CSRF-Token'] = csrfToken;\n    }\n\n    try {\n      const response = await axios.post(\n        'http://localhost:5000/api/login', \n        { name: username, password },\n        {\n          withCredentials: true, \n          headers: requestHeaders, \n        }\n      );\n\n      console.log('Login successful, server response:', response.data);\n\n      if (typeof updateAuthState === 'function') {\n        updateAuthState(true, response.data.user); \n      }\n\n      navigate('/home', { replace: true });\n    } catch (err) {\n      let errorMessage = 'Error while auth';\n      if (err.response && err.response.data && err.response.data.message) {\n        errorMessage = err.response.data.message;\n      } else if (err.message) {\n        errorMessage = err.message;\n      }\n      setError(errorMessage);\n      console.error(\"Login error:\", err.response || err.message || err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"auth-container\">\n      <div className=\"auth-card\">\n        <h1 className=\"auth-title\">Authorize</h1>\n\n        {error && <div className=\"auth-error\">{error}</div>}\n\n        <form onSubmit={handleSubmit} className=\"auth-form\">\n          <div className=\"form-group\">\n            <label htmlFor=\"username\">Login</label>\n            <input\n              type=\"text\"\n              id=\"username\"\n              value={username}\n              onChange={(e) => setUsername(e.target.value)}\n              required\n              placeholder=\"Enter your login\"\n              autoComplete=\"username\"\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label htmlFor=\"password\">Password</label>\n            <input\n              type=\"password\"\n              id=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              required\n              placeholder=\"Enter your password\"\n              autoComplete=\"current-password\"\n            />\n          </div>\n\n          \n\n          <button\n            type=\"submit\"\n            className=\"auth-button\"\n            disabled={isLoading}\n          >\n            {isLoading ? 'Entering...' : 'Submit'}\n          </button>\n        </form>\n\n        <div className=\"auth-footer\">\n          No account? <a> lol go cry then</a>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default AuthPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}