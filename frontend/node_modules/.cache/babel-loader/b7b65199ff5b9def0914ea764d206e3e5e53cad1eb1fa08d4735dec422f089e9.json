{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Routes,Route,Navigate}from'react-router-dom';import axios from'axios';import AuthPage from'./pages/AuthPage';import NotFound from'./pages/NotFound';import Detail from'./pages/Detail';import Layout from'./components/Layout';import Profile from'./pages/Profile';import Form from'./pages/Form';import Home from'./pages/Home';import'./css/App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{isAuthenticated,isLoading,children}=_ref;if(isLoading){return/*#__PURE__*/_jsx(\"p\",{children:\"Checking authentication...\"});}if(!isAuthenticated){return/*#__PURE__*/_jsx(Navigate,{to:\"/auth\",replace:true});}return children;};function App(){const[isAuthenticated,setIsAuthenticated]=useState(null);const[isLoading,setIsLoading]=useState(true);useEffect(()=>{const checkInitialAuth=async()=>{setIsLoading(true);try{const response=await axios.get('http://localhost:5000/api/protected',{withCredentials:true});console.log(\"User is authenticated:\",response.data);setIsAuthenticated(true);}catch(error){var _error$response;console.error(\"Auth check failed:\",((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data)||error.message);setIsAuthenticated(false);}finally{setIsLoading(false);}};if(isAuthenticated===null){checkInitialAuth();}else{setIsLoading(false);}},[isAuthenticated]);const handleAuthChange=status=>{setIsAuthenticated(status);console.log(\"Auth state updated:\",status);};return/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/auth\",element:isLoading?/*#__PURE__*/_jsx(\"p\",{children:\"Loading...\"}):isAuthenticated?/*#__PURE__*/_jsx(Navigate,{to:\"/home\",replace:true}):/*#__PURE__*/_jsx(AuthPage,{updateAuthState:handleAuthChange})}),/*#__PURE__*/_jsxs(Route,{path:\"/\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isAuthenticated:isAuthenticated,isLoading:isLoading,children:/*#__PURE__*/_jsx(Layout,{handleLogout:()=>handleAuthChange(false)})}),children:[/*#__PURE__*/_jsx(Route,{index:true,element:/*#__PURE__*/_jsx(Navigate,{to:\"/home\",replace:true})}),/*#__PURE__*/_jsx(Route,{path:\"home\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"profile\",element:/*#__PURE__*/_jsx(Profile,{})}),/*#__PURE__*/_jsx(Route,{path:\"add\",element:/*#__PURE__*/_jsx(Form,{})}),/*#__PURE__*/_jsx(Route,{path:\"detail/:id\",element:/*#__PURE__*/_jsx(Detail,{})})]}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(NotFound,{})})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","Routes","Route","Navigate","axios","AuthPage","NotFound","Detail","Layout","Profile","Form","Home","jsx","_jsx","jsxs","_jsxs","ProtectedRoute","_ref","isAuthenticated","isLoading","children","to","replace","App","setIsAuthenticated","setIsLoading","checkInitialAuth","response","get","withCredentials","console","log","data","error","_error$response","message","handleAuthChange","status","path","element","updateAuthState","handleLogout","index"],"sources":["/home/anton/laba4/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Routes, Route, Navigate } from 'react-router-dom';\nimport axios from 'axios';\nimport AuthPage from './pages/AuthPage';\nimport NotFound from './pages/NotFound';\nimport Detail from './pages/Detail';\nimport Layout from './components/Layout';\nimport Profile from './pages/Profile';\nimport Form from './pages/Form';\nimport Home from './pages/Home';\nimport './css/App.css';\n\nconst ProtectedRoute = ({ isAuthenticated, isLoading, children }) => {\n  if (isLoading) {\n    return <p>Checking authentication...</p>;\n  }\n\n  if (!isAuthenticated) {\n    return <Navigate to=\"/auth\" replace />;\n  }\n\n  return children;\n};\n\nfunction App() {\n  const [isAuthenticated, setIsAuthenticated] = useState(null); \n  const [isLoading, setIsLoading] = useState(true);\n\n\n  useEffect(() => {\n    const checkInitialAuth = async () => {\n      setIsLoading(true);\n      try {\n        const response = await axios.get('http://localhost:5000/api/protected', {\n          withCredentials: true,\n        });\n        console.log(\"User is authenticated:\", response.data);\n        setIsAuthenticated(true); \n      } catch (error) {\n        console.error(\"Auth check failed:\", error.response?.data || error.message);\n        setIsAuthenticated(false); \n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    if (isAuthenticated === null) {\n      checkInitialAuth();\n    } else {\n      setIsLoading(false);\n    }\n  }, [isAuthenticated]); \n\n  const handleAuthChange = (status) => {\n    setIsAuthenticated(status);\n    console.log(\"Auth state updated:\", status);\n  };\n\n  return (\n    <Routes>\n      <Route\n        path=\"/auth\"\n        element={\n          isLoading ? (\n            <p>Loading...</p>\n          ) : isAuthenticated ? (\n            <Navigate to=\"/home\" replace />\n          ) : (\n            <AuthPage updateAuthState={handleAuthChange} />\n          )\n        }\n      />\n\n      <Route\n        path=\"/\"\n        element={\n          <ProtectedRoute isAuthenticated={isAuthenticated} isLoading={isLoading}>\n            <Layout handleLogout={() => handleAuthChange(false)} />\n          </ProtectedRoute>\n        }\n      >\n        <Route index element={<Navigate to=\"/home\" replace />} />\n        <Route path=\"home\" element={<Home />} />\n        <Route path=\"profile\" element={<Profile />} />\n        <Route path=\"add\" element={<Form />} />\n        <Route path=\"detail/:id\" element={<Detail />} />\n      </Route>\n\n      <Route path=\"*\" element={<NotFound />} />\n    </Routes>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}